import 'package:flutter/cupertino.dart';import 'package:flutter/material.dart';import 'package:flutter_snake_navigationbar/flutter_snake_navigationbar.dart';import 'package:get/get.dart';import 'package:get/get_core/src/get_main.dart';import 'package:get/get_navigation/src/snackbar/snackbar.dart';import 'package:get/get_rx/src/rx_types/rx_types.dart';import 'package:get/get_state_manager/src/rx_flutter/rx_obx_widget.dart';import 'package:google_fonts/google_fonts.dart';import 'package:hoomy_project1/NavigationBar/NavigationBar_defult.dart';import 'package:hoomy_project1/help/text_style.dart';import 'package:loading_animations/loading_animations.dart';import 'package:unicons/unicons.dart';import 'package:url_launcher/url_launcher.dart';import 'package:whatsapp_unilink/whatsapp_unilink.dart';import '../Sign_up_page/Sign_up_main_page.dart';import '../Sign_up_page/text_Field.dart';import '../api/Api_calls.dart';import '../api/api_Url.dart';import '../favorite_page/NavigationBar_Container_favorit.dart';import '../help/Colors.dart';import '../landing/button.dart';import '../profile_page/blue_logo.dart';import 'package:whatsapp/whatsapp.dart';Whatsapp whatsapp = Whatsapp();class whatsapp_main_page extends StatefulWidget {  const whatsapp_main_page({Key? key, required this.text}) : super(key: key);  final String text;  @override  State<whatsapp_main_page> createState() => _whatsapp_main_pageState(text);}class _whatsapp_main_pageState extends State<whatsapp_main_page> {  final String text;  final TextEditingController Phone_number = TextEditingController();  final TextEditingController location = TextEditingController();  static final RxString typed_Phone_number = ''.obs;  static final RxString typed_location = ''.obs;  _whatsapp_main_pageState(this.text);  RxBool flags = true.obs;  Widget build(BuildContext context) {    return Scaffold(        backgroundColor: Colors.white,        body: SafeArea(          child: SingleChildScrollView(              child: Column(                  mainAxisAlignment: MainAxisAlignment.start,                  crossAxisAlignment: CrossAxisAlignment.center,                  children: [                Hoomy_logo_blue(onPressed: () {                  Navigator.of(context).pop();                }),                Padding(                  padding: const EdgeInsets.only(top: 20, bottom: 15),                  child: Text("لتأكيد عملية الشراء",                      textDirection: TextDirection.rtl,                      style: Text_Style.getstyle(                          fontsize: 25,                          ColorText: Colors.black,                          fontWeight: FontWeight.w700)),                ),                Padding(                  padding: const EdgeInsets.only(bottom: 10),                  child: Text("أملئ البيانات التالية:",                      textDirection: TextDirection.rtl,                      style: Text_Style.getstyle(                          fontsize: 20,                          ColorText: Colors.black,                          fontWeight: FontWeight.w700)),                ),                Obx(() {                  return Text_Field1(                    keyboardType: TextInputType.phone,                    MyController: Phone_number,                    onChanged: (text) {                      typed_Phone_number.value = text;                      print(text);                    },                    hintText: 'رقم الهاتف :'.obs,                    icon: Icon((Icons.phone),                        color: typed_Phone_number.value.isEmpty                            ? Colors.black38                            : Color(0xff45B9EE)),                    labelText: ''.obs,                    pass: false,                  );                }),                Obx(() {                  return Text_Field1(                    keyboardType: TextInputType.streetAddress,                    MyController: location,                    onChanged: (text) {                      typed_location.value = text;                      print(text);                    },                    hintText: 'العنوان او أقرب نقطة دالة:'.obs,                    icon: Icon((Icons.location_on),                        color: typed_location.value.isEmpty                            ? Colors.black38                            : Color(0xff45B9EE)),                    labelText: ''.obs,                    pass: false,                  );                }),                Padding(                  padding: const EdgeInsets.only(bottom: 20),                  child: Image.asset(                    "photo/Messeng.png",                    height: 300,                    width: 300,                  ),                ),                Obx(() {                  return Container(                      width: 337,                      height: 50,                      child: RawMaterialButton(                        onPressed: () async {                          print("${flags.value} قبل الدوسة ");                          flags.value = false;                          print("${flags.value} بعد الدوسة ");                          //await length_check();                          if (length_check() == true) {                            print("كفووو صار طلبك");                            Future.delayed(Duration(seconds: 2), () {                              //flags.value = true;                              print("${flags.value} بل فنكشن ");                              showDialogFunc(context,                                  "photo/Successful purchase-pana-modified.png");                            });                            Future.delayed(Duration(seconds: 4), () {                              Navigator.of(context).pop();                              print("فنكسن الواتساب");                            });                            Future.delayed(Duration(seconds: 2), () {                              launchWhatsApp(                                  text: "${text} \n \n"                                      " لعنوان : "                                      "   ${typed_location.value}\n"                                      " رقم الهاتف  : "                                      "   ${typed_Phone_number.value}\n");                            });                          }                          Future.delayed(Duration(seconds: 2), () {                            flags.value = true;                          });                        },                        fillColor: Color.fromRGBO(69, 185, 238, 1),                        shape: RoundedRectangleBorder(                            borderRadius: BorderRadius.circular(18)),                        child: flags.value == true                            ? Padding(                                padding:                                    const EdgeInsets.symmetric(horizontal: 50),                                child: Row(                                  mainAxisAlignment:                                      MainAxisAlignment.spaceBetween,                                  children: [                                    Icon(                                      Icons.whatsapp,                                      color: Colors.white,                                      size: 35,                                    ),                                    Padding(                                      padding: const EdgeInsets.only(top: 5),                                      child: Text(                                          textDirection: TextDirection.rtl,                                          "أرسال عبر Whatsapp",                                          style: Text_Style.getstyle(                                              fontsize: 20,                                              ColorText: Colors.white,                                              fontWeight: FontWeight.w700)),                                    ),                                  ],                                ),                              )                            : LoadingBouncingLine.circle(                                size: 70, backgroundColor: Colors.white),                      ));                })              ])),        ),        //bottomNavigationBar: NavigationBar_defult()    );  }  // void openWhatsappChat(String text) async {  //   String phone = '+9647835130173';  //   //await launch('https://wa.me/07777?');  //   var url = "https://wa.me/$phone?$text";  //   if (await canLaunch(url)) {  //     await launch(url);  //   } else {  //     throw "Could not launch $url";  //   }  // }  _launchUrl({@required text5}) async {    //String phone = '+964';    String phone2 = '7835130173';    final Uri _url = Uri.parse(        "https://api.whatsapp.com/send/?phone=9647835130173&text=%D9%87%D9%84%D9%88&type=phone_number&app_absent=0");    if (!await launchUrl(_url)) {      throw 'Could not launch $_url';    }  }  launchWhatsApp({required String? text}) async {    WhatsAppUnilink link = WhatsAppUnilink(      phoneNumber: '9647835130173',      text: text,    );    await launch('$link');  }  length_check() {    print("منا بدة الفنكسن");    bool flag = false;    if (Phone_number.text.isEmpty || location.text.isEmpty) {      Get.showSnackbar(GetSnackBar(        backgroundColor: Colors.red,        duration: Duration(seconds: 2),        messageText: Text('النص فارغ',            textDirection: TextDirection.rtl,            style: Text_Style.getstyle(                fontsize: 15,                ColorText: Colors.white,                fontWeight: FontWeight.w400)),      ));      flag = false;    } else if (double.tryParse(Phone_number.text) == null) {      Get.showSnackbar(GetSnackBar(        backgroundColor: Colors.red,        duration: Duration(seconds: 2),        messageText: Text('رقم الهاتف يجب ان يحتوي على ارقام فقط',            textDirection: TextDirection.rtl,            style: Text_Style.getstyle(                fontsize: 15,                ColorText: Colors.white,                fontWeight: FontWeight.w400)),      ));      flag = false;    } else {      flag = true;      print("يابة شسالفة ");      return true;    }  }  showDialogFunc(context, String img) {    return showDialog(      context: context,      builder: (context) {        return Center(          child: Material(            type: MaterialType.transparency,            child: Padding(              padding: const EdgeInsets.all(8.0),              child: GestureDetector(                onTap: () {                  Future.delayed(Duration(seconds: 3), () {                    Navigator.of(context).pop();                  });                },                child: Container(                  decoration: BoxDecoration(                    borderRadius: BorderRadius.circular(50),                    color: Colors.transparent,                  ),                  child: Column(                    crossAxisAlignment: CrossAxisAlignment.center,                    children: <Widget>[                      ClipRRect(                        borderRadius: BorderRadius.circular(50),                        child: Image.asset(                          img,                          height: MediaQuery.of(context).size.height - 80,                          width: MediaQuery.of(context).size.width,                        ),                      ),                    ],                  ),                ),              ),            ),          ),        );      },    );  }}